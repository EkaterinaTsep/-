# Проект "Маркетинг" — Прогнозирование покупок клиентов интернет-магазина

## Описание проекта

Интернет-магазин собирает данные о покупках клиентов и проводит маркетинговые рассылки. Цель проекта — предсказать вероятность того, что клиент совершит покупку в течение следующих 90 дней. Это позволяет оптимизировать маркетинговые кампании и повысить эффективность продаж.

## Цели и задачи

- Изучить и подготовить исходные данные
- Разработать информативные признаки на основе покупок и рассылок
- Обучить модель классификации для предсказания вероятности покупки
- Максимизировать качество модели по метрике ROC AUC
- Провести тестирование и оценку модели

## Данные

- **apparel-purchases (dfp)** — история покупок клиентов с информацией о товарах, количестве, цене, категориях и датах.
- **apparel-messages (dfm)** — данные о маркетинговых рассылках: события (отправлено, открыто, покупка), каналы и даты.
- **apparel-target_binary (dft)** — целевой признак: совершил ли клиент покупку в течение 90 дней.

## Используемые технологии и библиотеки

- Python 3.x
- pandas — обработка данных
- scikit-learn — подготовка данных, метрики, балансировка классов
- CatBoost — обучение модели градиентного бустинга
- Jupyter Notebook — интерактивный анализ и обучение

## Структура репозитория

- `notebook.ipynb` — Jupyter Notebook с полным описанием проекта, подготовкой данных, обучением и тестированием модели
- `README.md` — данный файл с описанием проекта и инструкциями

## Краткое описание процесса

1. Импорт и первичный анализ данных, преобразование дат в формат datetime.
2. Очистка данных: удаление дубликатов, агрегация признаков по клиентам.
3. Обработка вложенных категорий товаров с учетом изменений структуры.
4. Формирование признаков по покупкам и рассылкам, включая временные характеристики.
5. Балансировка классов с помощью оверсемплинга из-за сильного дисбаланса.
6. Анализ мультиколлинеарности и отбор признаков.
7. Обучение модели CatBoost с подбором гиперпараметров и ранней остановкой.
8. Оценка качества модели по ROC AUC, анализ важности признаков.
9. Тестирование и подготовка модели к применению.

## Результаты

- Модель достигает ROC AUC около 0.68, что является хорошим результатом для данной задачи.
- Важнейшими признаками оказались активность в рассылках, средний чек и суммарные затраты.
- Модель устойчива к переобучению благодаря ранней остановке и оптимальному подбору параметров.
